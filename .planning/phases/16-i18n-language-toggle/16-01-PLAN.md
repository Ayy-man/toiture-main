---
phase: 16
plan: 01
title: I18n Language Toggle Implementation
wave: 1
depends_on: []
files_modified:
  - frontend/src/lib/i18n/en.ts
  - frontend/src/lib/i18n/index.ts
  - frontend/src/lib/i18n/context.tsx
  - frontend/src/components/admin/app-sidebar.tsx
  - frontend/src/app/(admin)/layout.tsx
autonomous: true
---

# Plan 16-01: I18n Language Toggle Implementation

## Objective

Implement site-wide English/French language toggle with persistent preference using React Context and localStorage.

## Tasks

<task id="1" name="Create English translations file">
Create `frontend/src/lib/i18n/en.ts` with all English translations matching the existing fr.ts structure exactly.

**File:** `frontend/src/lib/i18n/en.ts`

Translate all keys from fr.ts to English:
- nav: Estimator, History, Overview, Clients
- estimateur: Price, Materials, Full Quote, etc.
- historique: Quote History, Filters, Export CSV
- apercu: Dashboard, Total Revenue, etc.
- clients: Search, Lifetime Value, Segment
- common: Loading, Error, Retry, Page, etc.
- fullQuote: Full Quote, Generate, Work Items, Summary, etc.
</task>

<task id="2" name="Create language context and hook" depends_on="1">
Create `frontend/src/lib/i18n/context.tsx` with:
- LanguageContext with current locale and setLocale
- LanguageProvider component that:
  - Reads initial locale from localStorage (default: 'fr')
  - Persists locale changes to localStorage
  - Provides `t` function for translations
- useLanguage hook for consuming context
- Type-safe translation keys
</task>

<task id="3" name="Create i18n barrel export" depends_on="2">
Create `frontend/src/lib/i18n/index.ts` that exports:
- fr translations
- en translations
- LanguageProvider
- useLanguage hook
- Locale type ('en' | 'fr')
</task>

<task id="4" name="Add LanguageProvider to root layout" depends_on="3">
Update `frontend/src/app/(admin)/layout.tsx` to wrap children with LanguageProvider.

The provider should be inside SidebarProvider but wrap everything else.
</task>

<task id="5" name="Add language toggle to sidebar" depends_on="4">
Update `frontend/src/components/admin/app-sidebar.tsx` to add language toggle in the sidebar footer:
- Two-button toggle (EN | FR) with active state styling
- Uses useLanguage hook to get/set locale
- Positioned in SidebarFooter above the user info
</task>

<task id="6" name="Update components to use translations" depends_on="5">
Update key components to use the `useLanguage` hook instead of direct fr imports:
- app-sidebar.tsx (nav items)
- Admin layout breadcrumb labels
- Any hardcoded French strings in the (admin) pages

Note: Most components already use fr.ts via import, so we need to switch them to use the hook.
</task>

## Verification

```bash
# Build should succeed
cd frontend && pnpm build

# Check files exist
ls -la src/lib/i18n/
```

## must_haves

- [ ] en.ts has all keys matching fr.ts structure
- [ ] LanguageProvider persists to localStorage
- [ ] Language toggle visible in sidebar footer
- [ ] Toggle switches between EN/FR
- [ ] Page refresh preserves language choice
- [ ] Default language is French
