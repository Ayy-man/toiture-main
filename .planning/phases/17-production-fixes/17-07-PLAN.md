---
phase: 17-production-fixes
plan: 07
type: polish
wave: 4
depends_on: ["17-01"]
autonomous: true

files_modified:
  - frontend/src/lib/i18n/fr.ts
  - frontend/src/lib/i18n/en.ts
  - frontend/src/components/estimateur/estimate-form.tsx
  - frontend/src/components/estimateur/estimate-result.tsx

must_haves:
  truths:
    - "No English strings remain on any page when French is selected"
    - "All hardcoded English replaced with translation keys"
    - "EN/FR toggle still functional"
---

<objective>
Complete French translation by replacing all remaining hardcoded English strings.

Purpose: Prix tab and other pages still have English strings despite the i18n system being in place.

Output: Fully French UI with no English strings when French is selected.
</objective>

<context>
@.planning/phases/17-production-fixes/17-RESEARCH.md
@frontend/src/lib/i18n/fr.ts
@frontend/src/components/estimateur/estimate-form.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit All English Strings</name>
  <action>
Search for remaining English strings in frontend:

```bash
# Find potential hardcoded strings in TSX files
grep -r "Total roof area\|Type of roofing\|Number of material\|Number of labor\|Will this job\|Job complexity\|Get Estimate\|Similar Cases\|Historical jobs\|Confidence\|match\|AI Reasoning\|Generating" frontend/src/

# Find strings that should be translated
grep -rn '"[A-Z][a-z]' frontend/src/components/ | grep -v "import\|from\|className"
```

Document all English strings that need translation.
  </action>
  <done>
    - All English strings documented
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Missing Translation Keys</name>
  <files>
    frontend/src/lib/i18n/fr.ts
    frontend/src/lib/i18n/en.ts
  </files>
  <action>
Add the missing translation keys:

**French (fr.ts) - Add to estimator section:**
```typescript
estimator: {
  // Existing keys...

  // Form labels
  sqftLabel: "Superficie totale du toit en pi²",
  sqftPlaceholder: "ex: 2500",
  categoryLabel: "Type de travaux",
  materialLinesLabel: "Nombre de lignes de matériaux",
  laborLinesLabel: "Nombre de lignes de main-d'œuvre",
  hasSubsLabel: "Ce projet implique-t-il des sous-traitants?",
  complexityLabel: "Complexité du projet (1 = simple, 100 = très complexe)",

  // Buttons
  getEstimate: "Obtenir l'estimation",

  // Results
  estimate: "Estimation",
  priceRange: "Fourchette de prix",
  similarCases: "Cas similaires",
  historicalJobs: "Soumissions historiques pour comparaison",
  aiReasoning: "Raisonnement IA",
  generating: "Génération...",

  // Confidence
  highConfidence: "Confiance ÉLEVÉE",
  mediumConfidence: "Confiance MOYENNE",
  lowConfidence: "Confiance FAIBLE",

  // Similar cases
  match: "similaire",
  sqft: "pi²",
  total: "total",

  // Categories
  categories: {
    shingle: "Bardeaux",
    elastomere: "Élastomère",
    other: "Autre",
    service: "Appel de service"
  }
}
```

**English (en.ts) - Add matching keys:**
```typescript
estimator: {
  // Form labels
  sqftLabel: "Total roof area in square feet",
  sqftPlaceholder: "e.g., 2500",
  categoryLabel: "Type of roofing job",
  materialLinesLabel: "Number of material line items",
  laborLinesLabel: "Number of labor line items",
  hasSubsLabel: "Will this job involve subcontractors?",
  complexityLabel: "Job complexity (1 = simple, 100 = very complex)",

  // Buttons
  getEstimate: "Get Estimate",

  // Results
  estimate: "Estimate",
  priceRange: "Price Range",
  similarCases: "Similar Cases",
  historicalJobs: "Historical jobs for comparison",
  aiReasoning: "AI Reasoning",
  generating: "Generating...",

  // Confidence
  highConfidence: "HIGH Confidence",
  mediumConfidence: "MEDIUM Confidence",
  lowConfidence: "LOW Confidence",

  // Similar cases
  match: "match",
  sqft: "sqft",
  total: "total",

  // Categories
  categories: {
    shingle: "Shingle",
    elastomere: "Elastomere",
    other: "Other",
    service: "Service Call"
  }
}
```
  </action>
  <done>
    - All translation keys added to fr.ts
    - All translation keys added to en.ts
  </done>
</task>

<task type="auto">
  <name>Task 3: Update Estimate Form Component</name>
  <files>
    frontend/src/components/estimateur/estimate-form.tsx
  </files>
  <action>
Replace hardcoded strings with translation keys:

```typescript
// Before:
<Label>Total roof area in square feet</Label>

// After:
<Label>{t.estimator.sqftLabel}</Label>
```

Update all form labels:
- sqft label and placeholder
- category label
- material lines label
- labor lines label
- has_subs label
- complexity label
- submit button text

Ensure the component uses `useLanguage()` hook:
```typescript
const { t } = useLanguage();
```
  </action>
  <done>
    - All form labels use translation keys
  </done>
</task>

<task type="auto">
  <name>Task 4: Update Estimate Result Component</name>
  <files>
    frontend/src/components/estimateur/estimate-result.tsx
  </files>
  <action>
Replace hardcoded strings in results display:

```typescript
// Before:
<h3>Similar Cases</h3>
<p>Historical jobs for comparison</p>

// After:
<h3>{t.estimator.similarCases}</h3>
<p>{t.estimator.historicalJobs}</p>
```

Update:
- "Estimate" heading
- "Similar Cases" heading and description
- "AI Reasoning" heading
- "Generating..." loading text
- Confidence level labels (HIGH/MEDIUM/LOW)
- "match" and "total" in similar cases
  </action>
  <done>
    - All result labels use translation keys
  </done>
</task>

<task type="auto">
  <name>Task 5: Verify All Pages</name>
  <action>
Check every page for remaining English strings:

```bash
# Search for common English patterns
grep -rn "Estimate\|Submit\|Loading\|Error\|Success" frontend/src/components/ | grep -v ".test." | grep -v "// "

# Check for untranslated aria-labels
grep -rn 'aria-label="[A-Z]' frontend/src/
```

Common places to check:
- Button text
- Form labels and placeholders
- Error messages
- Loading states
- Tooltips and aria-labels
- Toast notifications
  </action>
  <done>
    - All pages audited
    - No English strings when French selected
  </done>
</task>

<task type="auto">
  <name>Task 6: Build and Deploy</name>
  <action>
```bash
cd frontend
pnpm run build
```

If build passes, the changes will auto-deploy to Vercel on push.

```bash
git add -A
git commit -m "fix(i18n): translate all hardcoded English strings in estimator"
git push
```
  </action>
  <verify>
```bash
# Build should pass
cd frontend && pnpm run build
echo $?  # Should be 0
```
  </verify>
  <done>
    - Build passes
    - Changes deployed
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Completed French translation by replacing all hardcoded English strings.
  </what-built>
  <how-to-verify>
    1. Ensure French is selected (FR toggle in sidebar)
    2. Go through every page:
       - Estimateur → Prix tab (form and results)
       - Estimateur → Soumission Complète tab
       - Estimateur → Matériaux tab
       - Historique page
       - Aperçu page
       - Clients page
    3. Look for ANY English text
    4. Toggle to English and verify English labels appear
    5. Toggle back to French and verify French labels appear
  </how-to-verify>
  <resume-signal>Type "approved" if no English strings remain, or list any you found</resume-signal>
</task>

</tasks>

<verification>
- [ ] No English strings on Prix tab form
- [ ] No English strings on Prix tab results
- [ ] No English strings on Soumission Complète tab
- [ ] No English strings on Matériaux tab
- [ ] No English strings on Historique page
- [ ] No English strings on Aperçu page
- [ ] No English strings on Clients page
- [ ] EN/FR toggle works correctly
- [ ] Build passes
</verification>

<success_criteria>
1. All user-visible text uses translation system
2. French UI is complete when FR selected
3. English UI is complete when EN selected
4. Toggle switches all text correctly
</success_criteria>

<output>
After completion, create `.planning/phases/17-production-fixes/17-07-SUMMARY.md`
</output>
