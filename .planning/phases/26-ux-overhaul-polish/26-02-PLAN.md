---
phase: 26-ux-overhaul-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/ui/skeleton.tsx
  - frontend/src/components/shared/table-skeleton.tsx
  - frontend/src/components/shared/card-skeleton.tsx
  - frontend/src/components/shared/chart-skeleton.tsx
  - frontend/src/components/shared/empty-state.tsx
  - frontend/src/components/historique/quote-table.tsx
  - frontend/src/components/apercu/metrics-cards.tsx
  - frontend/src/components/dashboard/dashboard-content.tsx
  - frontend/src/components/dashboard/stats-cards.tsx
  - frontend/src/app/(admin)/clients/page.tsx
  - frontend/src/components/estimateur/submission-list.tsx
  - frontend/src/components/estimate-form.tsx
  - frontend/src/components/estimateur/full-quote-form.tsx
  - frontend/src/components/estimateur/submission-editor.tsx
  - frontend/src/components/submissions/send-dialog.tsx
  - frontend/src/components/estimateur/feedback-panel.tsx
  - frontend/src/lib/i18n/fr.ts
  - frontend/src/lib/i18n/en.ts
autonomous: true

must_haves:
  truths:
    - "Every loading state shows skeleton animation instead of text"
    - "Every user action triggers a toast notification"
    - "Every list page shows an empty state with icon and message when no data"
  artifacts:
    - path: "frontend/src/components/ui/skeleton.tsx"
      provides: "shadcn skeleton primitive"
      contains: "Skeleton"
    - path: "frontend/src/components/shared/table-skeleton.tsx"
      provides: "Reusable table skeleton loader"
      exports: ["TableSkeleton"]
    - path: "frontend/src/components/shared/empty-state.tsx"
      provides: "Reusable empty state with icon, title, description, CTA"
      exports: ["EmptyState"]
  key_links:
    - from: "frontend/src/components/historique/quote-table.tsx"
      to: "frontend/src/components/shared/table-skeleton.tsx"
      via: "import TableSkeleton"
      pattern: "TableSkeleton"
    - from: "frontend/src/components/estimateur/submission-editor.tsx"
      to: "frontend/src/hooks/use-toast.ts"
      via: "import useToast"
      pattern: "useToast|toast"
    - from: "frontend/src/components/estimateur/submission-list.tsx"
      to: "frontend/src/components/shared/empty-state.tsx"
      via: "import EmptyState"
      pattern: "EmptyState"
---

<objective>
Add skeleton loaders for all loading states, toast notifications for all user actions, and empty states for all list pages.

Purpose: UX-03 (skeleton loaders), UX-04 (toast notifications), UX-08 (empty states) -- these are foundational UX patterns that make the app feel professional and responsive.
Output: Reusable skeleton/empty-state components, toasts wired into all action handlers, loading text replaced with skeletons.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/src/hooks/use-toast.ts
@frontend/src/components/ui/toast.tsx
@frontend/src/components/historique/quote-table.tsx
@frontend/src/components/apercu/metrics-cards.tsx
@frontend/src/components/dashboard/dashboard-content.tsx
@frontend/src/components/estimateur/submission-list.tsx
@frontend/src/components/estimateur/submission-editor.tsx
@frontend/src/components/submissions/send-dialog.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create skeleton, empty-state components and wire skeletons into loading states</name>
  <files>
    frontend/src/components/ui/skeleton.tsx
    frontend/src/components/shared/table-skeleton.tsx
    frontend/src/components/shared/card-skeleton.tsx
    frontend/src/components/shared/chart-skeleton.tsx
    frontend/src/components/shared/empty-state.tsx
    frontend/src/components/historique/quote-table.tsx
    frontend/src/components/apercu/metrics-cards.tsx
    frontend/src/components/dashboard/dashboard-content.tsx
    frontend/src/components/dashboard/stats-cards.tsx
    frontend/src/app/(admin)/clients/page.tsx
    frontend/src/components/estimateur/submission-list.tsx
    frontend/src/lib/i18n/fr.ts
    frontend/src/lib/i18n/en.ts
  </files>
  <action>
1. **Install shadcn skeleton** (if not exists):
   - Run `cd frontend && pnpm dlx shadcn@latest add skeleton` to install the skeleton primitive.
   - If it already exists (check first), skip.

2. **Create `TableSkeleton`** at `frontend/src/components/shared/table-skeleton.tsx`:
   - Props: `rows?: number` (default 5), `columns?: number` (default 4)
   - Renders a table structure with Skeleton elements: header row (shorter skeletons) + body rows (varying widths for natural look).
   - Uses shadcn `Skeleton` component. Example row: `<div className="flex gap-4">` with `<Skeleton className="h-4 w-[X]" />` for each column.
   - Wrap in a Card or div with proper spacing to match existing table styling.

3. **Create `CardSkeleton`** at `frontend/src/components/shared/card-skeleton.tsx`:
   - Renders a Card with Skeleton for title (h-4 w-24), value (h-8 w-32), and description (h-3 w-20).
   - Matches the KPI card layout used in apercu/metrics-cards and dashboard/stats-cards.

4. **Create `ChartSkeleton`** at `frontend/src/components/shared/chart-skeleton.tsx`:
   - Renders a Card with Skeleton for chart title + a rectangular skeleton area (h-[200px]) representing the chart.
   - Include subtle bar-chart-like shapes using multiple vertical Skeleton strips of varying heights inside the rectangle for visual interest.

5. **Create `EmptyState`** at `frontend/src/components/shared/empty-state.tsx`:
   - Props: `icon: React.ComponentType<{ className?: string }>`, `title: string`, `description: string`, `action?: { label: string; onClick: () => void }` (optional CTA button).
   - Renders centered layout: icon (size-12, text-muted-foreground/40), title (text-lg font-semibold), description (text-sm text-muted-foreground), optional Button.
   - Wrap in a `div` with `flex flex-col items-center justify-center py-16 text-center`.

6. **Replace loading states with skeletons**:
   - `quote-table.tsx`: Find where `loading` state renders "Loading..." text. Replace with `<TableSkeleton rows={8} columns={6} />`.
   - `metrics-cards.tsx`: Find loading state. Replace with 4 `<CardSkeleton />` in a grid matching the existing layout.
   - `dashboard-content.tsx`: Find loading state. Replace with `<CardSkeleton />` for stats + `<ChartSkeleton />` for charts.
   - `stats-cards.tsx` (if it exists as separate component): Replace loading with `<CardSkeleton />`.
   - `clients/page.tsx`: Find loading state for customer list. Replace with `<TableSkeleton />` or `<CardSkeleton />`.

7. **Add empty states** to list pages:
   - `submission-list.tsx`: When no submissions exist for current tab, show `<EmptyState icon={FileText} title={t.submission.noSubmissions} description="..." />`.
   - `clients/page.tsx`: When no client selected, show `<EmptyState icon={Users} title="..." description="Search for a client above" />`.
   - Read each file first to understand the current loading/empty patterns before modifying.

8. **Add i18n keys** for empty state messages:
   - `fr.ts` and `en.ts`: Add to `common` section:
     - `noData`: "Aucune donnee" / "No data"
     - `noResults`: "Aucun resultat" / "No results"
   - Add to `historique` section: `aucuneSoumission`: "Aucune soumission trouvee" / "No quotes found", `aucuneSoumissionDesc`: "Les soumissions apparaitront ici" / "Quotes will appear here"
  </action>
  <verify>
    - Run `cd frontend && npx next build` -- no compile errors
    - Grep for "Loading..." or "Chargement..." text in components to confirm replacements (should be minimal remaining)
  </verify>
  <done>
    - Skeleton primitive installed and working
    - 3 reusable skeleton components: TableSkeleton, CardSkeleton, ChartSkeleton
    - 1 reusable EmptyState component
    - All loading states in quote-table, metrics-cards, dashboard-content, clients page use skeletons
    - Empty states in submission-list and clients page
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire toast notifications into all user action handlers</name>
  <files>
    frontend/src/components/estimate-form.tsx
    frontend/src/components/estimateur/full-quote-form.tsx
    frontend/src/components/estimateur/submission-editor.tsx
    frontend/src/components/submissions/send-dialog.tsx
    frontend/src/components/estimateur/feedback-panel.tsx
  </files>
  <action>
1. **Read existing toast system**: Read `frontend/src/hooks/use-toast.ts` and `frontend/src/components/ui/toast.tsx` to understand the API (likely `const { toast } = useToast()` then `toast({ title, description, variant })` with variant "default" or "destructive").

2. **Wire toasts into `estimate-form.tsx`** (Prix tab quick estimate):
   - Import `useToast` from `@/hooks/use-toast`.
   - On successful estimate result: `toast({ title: t.resultat.estimation, description: "..." })`.
   - On error: `toast({ title: t.common.erreur, description: error message, variant: "destructive" })`.

3. **Wire toasts into `full-quote-form.tsx`** (full quote generation):
   - On successful quote generation (when `setResult(response)` is called): `toast({ title: t.fullQuote.titre, description: "Quote generated successfully" })`.
   - On error: `toast({ variant: "destructive", title: t.fullQuote.erreur, description: error message })`.
   - On successful submission creation (when `setSubmission(sub)` is called): `toast({ title: t.submission.submissionCreated })`.

4. **Wire toasts into `submission-editor.tsx`**:
   - Read the file first to identify all action handlers (save, finalize, approve, reject, return-to-draft, add note).
   - Each existing action likely already has success handling -- add toast calls:
     - Save: `toast({ title: t.submission.submissionUpdated })`
     - Finalize: `toast({ title: t.submission.submissionFinalized })`
     - Approve: `toast({ title: t.submission.submissionApproved })`
     - Reject: `toast({ title: t.submission.submissionRejected })`
     - Return to draft: `toast({ title: t.submission.submissionReturnedToDraft })`
     - Add note: `toast({ title: t.submission.noteAdded })`
   - On errors: `toast({ variant: "destructive", title: t.common.erreur, description: error })`.
   - NOTE: The i18n keys for these toast messages already exist in `t.submission.*` from Phase 23.

5. **Wire toasts into `send-dialog.tsx`**:
   - On send success: `toast({ title: t.sendDialog.envoyeAvecSucces })`
   - On schedule success: `toast({ title: t.sendDialog.planifieAvecSucces })`
   - On draft save: `toast({ title: t.sendDialog.brouillonSauvegarde })`
   - On error: `toast({ variant: "destructive", title: t.sendDialog.erreurEnvoi })`

6. **Wire toasts into `feedback-panel.tsx`**:
   - On successful feedback submit: `toast({ title: t.feedback.merci })`
   - On error: `toast({ variant: "destructive", title: t.feedback.erreurEnvoi })`

IMPORTANT: Read each file completely before modifying. Only add toast calls at success/error points. Do NOT restructure the components. The i18n keys already exist for most messages.
  </action>
  <verify>
    - Run `cd frontend && npx next build` -- no compile errors
    - Search for `useToast` imports across modified files to confirm wiring
  </verify>
  <done>
    - Toast on estimate result (Prix tab)
    - Toast on quote generation (Complet tab)
    - Toast on submission creation
    - Toast on all submission editor actions (save, finalize, approve, reject, return-to-draft, note)
    - Toast on send dialog actions (send, schedule, draft)
    - Toast on feedback submission
    - Destructive toast variant on all error states
  </done>
</task>

</tasks>

<verification>
- Grep for "Loading..." in component files -- should be replaced with Skeleton components
- Grep for "useToast" in all modified action handler files -- should be present
- EmptyState component renders with icon, title, description
- Build passes without errors
</verification>

<success_criteria>
- Every loading state uses skeleton loaders (no plain text "Loading..." in UI)
- Every user action triggers a toast notification (success or error)
- List pages show empty states when no data exists
- All new components are reusable with configurable props
</success_criteria>

<output>
After completion, create `.planning/phases/26-ux-overhaul-polish/26-02-SUMMARY.md`
</output>
