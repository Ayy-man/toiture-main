---
phase: 19-data-quality-labeling-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/lib/i18n/en.ts
  - frontend/src/lib/i18n/fr.ts
  - frontend/src/app/(admin)/apercu/page.tsx
  - frontend/src/components/apercu/metrics-cards.tsx
  - frontend/src/components/apercu/revenue-chart.tsx
  - frontend/src/components/apercu/category-chart.tsx
  - frontend/src/components/apercu/trend-chart.tsx
autonomous: true

must_haves:
  truths:
    - "Zero instances of 'Revenue' or 'Revenu' visible to users anywhere in the Apercu dashboard"
    - "KPI card reads 'Total Quote Value' in EN and 'Valeur totale des soumissions' in FR"
    - "Chart titles use 'quote value' / 'valeur des soumissions' wording instead of 'revenue'"
    - "Disclaimer banner visible above charts: 'These are quoted amounts, not invoiced revenue'"
  artifacts:
    - path: "frontend/src/lib/i18n/en.ts"
      provides: "Updated apercu labels with 'Total Quote Value'"
      contains: "Total Quote Value"
    - path: "frontend/src/lib/i18n/fr.ts"
      provides: "Updated apercu labels with 'Valeur totale des soumissions'"
      contains: "Valeur totale des soumissions"
    - path: "frontend/src/app/(admin)/apercu/page.tsx"
      provides: "Disclaimer banner and i18n chart titles"
      contains: "t.apercu.disclaimer"
  key_links:
    - from: "frontend/src/components/apercu/metrics-cards.tsx"
      to: "frontend/src/lib/i18n/en.ts"
      via: "t.apercu.revenuTotal → renamed label"
      pattern: "t\\.apercu\\.revenuTotal"
    - from: "frontend/src/app/(admin)/apercu/page.tsx"
      to: "frontend/src/lib/i18n/en.ts"
      via: "i18n keys for chart titles and disclaimer"
      pattern: "t\\.apercu\\."
---

<objective>
Replace all user-facing "Revenue" / "Revenu" labels with "Total Quote Value" / "Valeur totale des soumissions" across the Apercu dashboard, and add a disclaimer banner above financial charts clarifying these are quoted amounts, not invoiced revenue.

Purpose: Laurent identified that the current "Revenue" labels are misleading — the data represents quoted amounts, not actual invoiced revenue. This causes confusion when interpreting financial dashboards.

Output: Updated i18n labels, chart titles using i18n keys instead of hardcoded French, and a prominent disclaimer banner on the Apercu page.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/src/lib/i18n/en.ts
@frontend/src/lib/i18n/fr.ts
@frontend/src/app/(admin)/apercu/page.tsx
@frontend/src/components/apercu/metrics-cards.tsx
@frontend/src/components/apercu/revenue-chart.tsx
@frontend/src/components/apercu/category-chart.tsx
@frontend/src/components/apercu/trend-chart.tsx
@frontend/src/types/dashboard.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update i18n labels and add disclaimer + chart title keys</name>
  <files>
    frontend/src/lib/i18n/en.ts
    frontend/src/lib/i18n/fr.ts
  </files>
  <action>
In both `en.ts` and `fr.ts`, update the `apercu` section:

1. **Change `revenuTotal` label:**
   - EN: `revenuTotal: "Total Quote Value"` (was "Total Revenue")
   - FR: `revenuTotal: "Valeur totale des soumissions"` (was "Revenu total")

2. **Add new i18n keys to `apercu` section:**
   - `disclaimer` — EN: `"Note: All amounts shown represent quoted values, not invoiced revenue."` / FR: `"Note : Tous les montants affichés représentent des valeurs de soumissions, et non des revenus facturés."`
   - `valeurParAnnee` — EN: `"Quote value by year"` / FR: `"Valeur des soumissions par année"`
   - `valeurParCategorie` — EN: `"Quote value by category"` / FR: `"Valeur des soumissions par catégorie"`
   - `tendanceMensuelle` — EN: `"Monthly trend"` / FR: `"Tendance mensuelle"`
   - `topClients` — EN: `"Top clients"` / FR: `"Top clients"`

IMPORTANT: Do NOT rename the i18n key `revenuTotal` itself (that would break all references). Only change the string value it maps to. The key name is internal code, the value is user-facing.
  </action>
  <verify>
Run `grep -r "Total Revenue\|Revenu total" frontend/src/lib/i18n/` — should return zero results.
Run `grep -r "Total Quote Value" frontend/src/lib/i18n/en.ts` — should return 1 result.
Run `grep -r "Valeur totale des soumissions" frontend/src/lib/i18n/fr.ts` — should return 1 result.
  </verify>
  <done>
Both i18n files have updated label values for revenuTotal and 5 new keys (disclaimer, valeurParAnnee, valeurParCategorie, tendanceMensuelle, topClients) in both languages.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Apercu page with disclaimer banner and i18n chart titles</name>
  <files>
    frontend/src/app/(admin)/apercu/page.tsx
    frontend/src/components/apercu/metrics-cards.tsx
    frontend/src/components/apercu/revenue-chart.tsx
    frontend/src/components/apercu/category-chart.tsx
    frontend/src/components/apercu/trend-chart.tsx
  </files>
  <action>
**apercu/page.tsx:**
1. Add a disclaimer banner `<div>` between the `<MetricsCards>` component and the charts grid. Use an info-style alert with a muted background:
   ```tsx
   <div className="rounded-lg border border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950 px-4 py-3 text-sm text-blue-800 dark:text-blue-200">
     {t.apercu.disclaimer}
   </div>
   ```
2. Replace all 4 hardcoded French chart `<CardTitle>` strings with i18n keys:
   - `"Revenu par annee"` → `{t.apercu.valeurParAnnee}`
   - `"Revenu par categorie"` → `{t.apercu.valeurParCategorie}`
   - `"Tendance mensuelle"` → `{t.apercu.tendanceMensuelle}`
   - `"Top clients"` → `{t.apercu.topClients}`

**metrics-cards.tsx:**
- No code changes needed — it already uses `t.apercu.revenuTotal` which now maps to the new label.

**revenue-chart.tsx:**
- The chart dataKey `"revenue"` stays as-is (backend field name unchanged).
- No label changes needed (labels come from apercu/page.tsx CardTitle).

**category-chart.tsx:**
- The pie chart dataKey `"revenue"` stays as-is.
- No label changes needed.

**trend-chart.tsx:**
- The line chart dataKey `"revenue"` stays as-is.
- No label changes needed.

NOTE: Backend field names (`revenue`, `total_revenue`, `revenue_by_year`, `revenue_by_category`) remain unchanged per research decision — only user-facing labels change. TypeScript types in `frontend/src/types/dashboard.ts` also stay unchanged since they map to backend field names.
  </action>
  <verify>
1. Run `grep -rn "Revenu par\|Total Revenue\|Revenue" frontend/src/app/\(admin\)/apercu/page.tsx` — should return zero matches for hardcoded revenue strings (only comment references acceptable).
2. Run `grep "t.apercu.disclaimer" frontend/src/app/\(admin\)/apercu/page.tsx` — should return 1 result.
3. Run `grep "t.apercu.valeurPar" frontend/src/app/\(admin\)/apercu/page.tsx` — should return 2 results.
4. Check the app compiles: `cd frontend && npx next build --no-lint 2>&1 | tail -5` (should not error on import/type issues).
  </verify>
  <done>
Apercu page shows disclaimer banner between KPI cards and charts. All chart titles use i18n keys. Switching language toggles all labels correctly. No hardcoded "Revenue"/"Revenu" strings remain in user-facing components.
  </done>
</task>

</tasks>

<verification>
1. Start dev server, navigate to /apercu. Verify:
   - KPI card shows "Total Quote Value" (EN) or "Valeur totale des soumissions" (FR)
   - Disclaimer banner appears between KPIs and charts
   - All 4 chart titles use translated text, not hardcoded French
   - Toggle language — all labels switch correctly
2. Search entire `frontend/src` for hardcoded "Revenue", "Revenu total", "Total Revenue" — zero user-facing instances remain.
3. Backend field names (`revenue`, `total_revenue`) unchanged — no API breakage.
</verification>

<success_criteria>
- Zero instances of "Revenue"/"Revenu" in user-facing UI text
- Disclaimer banner visible on Apercu page in both languages
- All chart titles use i18n keys (no hardcoded French)
- App compiles without errors
- Backend API unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/19-data-quality-labeling-fixes/19-01-SUMMARY.md`
</output>
